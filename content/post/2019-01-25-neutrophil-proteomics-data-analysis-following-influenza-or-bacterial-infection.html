---
title: "Semi quantitative proteomics enables mapping of global neutrophil dynamics following influenza virus infection"
date: "2019-01-25"
author: Chuanxin Liu
categories:
- Research
- Coding
tags:
- research
- publication
image: "https://8heddw.ch.files.1drv.com/y4mSLrpvgdAbg0tTkx3RhzfRqpLs7L6xDT3U5NO7USxOLxnX0XjJFEg5j90FI-Xw9qovOyAX-e92EKz2hUT8QWsdLX2vB5J0KsxqxeWhgZQvT2O0LKq9YezyECWyCl5mZcAF_x2V5YpMXPUsK0VmA4wvUZui9_bQxt8RlEtQx-XqixRUR6kcIWCULI5HnhGhgQs?width=1920&height=1080&cropmode=none"
output:
  blogdown::html_page:
    dev: "svg" ## set the default output device to svg
    toc: true
---


<div id="TOC">
<ul>
<li><a href="#source-code-and-dataset-availability">Source code and dataset availability</a></li>
<li><a href="#prerequisite">Prerequisite</a></li>
<li><a href="#analysis-of-neutrophil-proteome-at-homeostasis-or-following-a-lethal-iav-infection">Analysis of neutrophil proteome at homeostasis or following a lethal IAV infection</a><ul>
<li><a href="#raw-data-cleaning">Raw data cleaning</a></li>
<li><a href="#visualization-of-pick-up-proteins-in-independent-experiments-and-biological-replicates">Visualization of pick-up proteins in independent experiments and biological replicates</a></li>
<li><a href="#overall-impression-of-proteome-dataset">Overall impression of proteome dataset</a></li>
<li><a href="#analysis-of-proteins-with-significant-abundance-changes">Analysis of proteins with significant abundance changes</a></li>
<li><a href="#ibaq-intensity-ranking">iBAQ intensity ranking</a></li>
</ul></li>
<li><a href="#analysis-of-bal-neutrophil-proteome-changes-following-different-doses-of-influenza-infection-or-bacterial-infection">Analysis of BAL neutrophil proteome changes following different doses of influenza infection or bacterial infection</a><ul>
<li><a href="#raw-data-cleaning-1">Raw data cleaning</a></li>
<li><a href="#overall-impression-of-datasets">Overall impression of datasets</a></li>
<li><a href="#analysis-of-proteins-with-significant-abundance-changes-1">Analysis of proteins with significant abundance changes</a></li>
</ul></li>
<li><a href="#state-of-the-machine">State of the machine</a></li>
</ul>
</div>

<div id="source-code-and-dataset-availability" class="section level2">
<h2>Source code and dataset availability</h2>
<p>Source code is hosted on <a href="https://github.com/codetrainee/Neutrophil-systems-biology">github</a></p>
</div>
<div id="prerequisite" class="section level2">
<h2>Prerequisite</h2>
<p>We first loaded libraries required for analysis. Scripts used in the analysis could be found in <code>data/Rscripts</code>. Packages and their version are specificed in a plain file as well as listed at the bottom of the page.</p>
<pre class="r"><code>source(&quot;data/Rscripts/load_libraries.R&quot;)
source(&quot;data/Rscripts/utilities.R&quot;)</code></pre>
<p>The theme for figures generated by ggplot2 was set to <code>dust</code> style from <a href="https://github.com/cttobin/ggthemr">ggthemr</a> packages.</p>
<pre class="r"><code>ggthemr(&quot;dust&quot;)</code></pre>
<p>To have a tidy output, the figures were centered and message and warning were suppressed by defaults. Code was also hidden for simplicity.</p>
<pre class="r"><code>knitr::opts_chunk$set(fig.align = &quot;center&quot;,
                      message   = FALSE,
                      warning   = FALSE,
                      cache     = TRUE,
                      echo      = FALSE,
                      results   = &quot;hide&quot;)</code></pre>
<p>All data were stored under the below folders and can be found in the <a href="##Source-code-and-dataset-availability">Source code and dataset availability</a></p>
<p>In raw files generated from <a href="https://www.maxquant.org/">MaxQuant</a> software, a plenty of <code>NA</code> values has to be removed before downstream analyses. To survive the filtering step, a pick-up protein should meet following requirements:</p>
<ul>
<li>should be detected in at least one comparison group.</li>
<li>should be picked up in all of three independent replicates.</li>
</ul>
</div>
<div id="analysis-of-neutrophil-proteome-at-homeostasis-or-following-a-lethal-iav-infection" class="section level2">
<h2>Analysis of neutrophil proteome at homeostasis or following a lethal IAV infection</h2>
<p>3 experiments were included in the analysis pipeline. The first two were combined together to identify neutrophil-derived markers in a 1000 pfu PR8 influenza infection compared to PBS treated control. The third experiment compared the neutrophil proteome in different doses of influenza infection and bacterial infection.</p>
<div id="raw-data-cleaning" class="section level3">
<h3>Raw data cleaning</h3>
<p>We first loaded datasets from two experiments and removed the potential contaminations marked by MaxQuant.</p>
<p>The datasets were annotated as below. Missing values were filtered out using customised functions.</p>
<table>
<caption><strong>Experiment 1 Biological replicate 1</strong></caption>
<thead>
<tr class="header">
<th>Labelling</th>
<th>Sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Light (L)</td>
<td>1000 PFU PR8 BM neutrophil</td>
</tr>
<tr class="even">
<td>Medium (M)</td>
<td>1000 PFU PR8 Blood neutrophil</td>
</tr>
<tr class="odd">
<td>Heavy (H)</td>
<td>1000 PFU PR8 BAL neutrophil</td>
</tr>
</tbody>
</table>
<table>
<caption><strong>Experiment 1 Biological replicate 2</strong></caption>
<thead>
<tr class="header">
<th>Labelling</th>
<th>Sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Light (L)</td>
<td>1000 PFU PR8 BAL neutrophil</td>
</tr>
<tr class="even">
<td>Medium (M)</td>
<td>1000 PFU PR8 BM neutrophil</td>
</tr>
<tr class="odd">
<td>Heavy (H)</td>
<td>1000 PFU PR8 Blood neutrophil</td>
</tr>
</tbody>
</table>
<table>
<caption><strong>Experiment 1 Biological replicate 3</strong></caption>
<thead>
<tr class="header">
<th>Labelling</th>
<th>Sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Light (L)</td>
<td>1000 PFU PR8 Blood neutrophil</td>
</tr>
<tr class="even">
<td>Medium (M)</td>
<td>1000 PFU PR8 BAL neutrophil</td>
</tr>
<tr class="odd">
<td>Heavy (H)</td>
<td>1000 PFU PR8 BM neutrophil</td>
</tr>
</tbody>
</table>
<table>
<caption><strong>Experiment 2 Biological replicate 1</strong></caption>
<thead>
<tr class="header">
<th>Labelling</th>
<th>Sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Light (L)</td>
<td>PBS BM neutrophil</td>
</tr>
<tr class="even">
<td>Medium (M)</td>
<td>PBS Blood neutrophil</td>
</tr>
<tr class="odd">
<td>Heavy (H)</td>
<td>1000 PFU PR8 BM neutrophil</td>
</tr>
</tbody>
</table>
<table>
<caption><strong>Experiment 2 Biological replicate 2</strong></caption>
<thead>
<tr class="header">
<th>Labelling</th>
<th>Sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Light (L)</td>
<td>1000 PFU PR8 BM neutrophil</td>
</tr>
<tr class="even">
<td>Medium (M)</td>
<td>PBS BM neutrophil</td>
</tr>
<tr class="odd">
<td>Heavy (H)</td>
<td>PBS Blood neutrophil</td>
</tr>
</tbody>
</table>
<table>
<caption><strong>Experiment 2 Biological replicate 3</strong></caption>
<thead>
<tr class="header">
<th>Labelling</th>
<th>Sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Light (L)</td>
<td>PBS Blood neutrophil</td>
</tr>
<tr class="even">
<td>Medium (M)</td>
<td>1000 PFU PR8 neutrophil</td>
</tr>
<tr class="odd">
<td>Heavy (H)</td>
<td>PBS BM neutrophil</td>
</tr>
</tbody>
</table>
<p>Proteins passed the filtering step were subjected to statistics tests for difference analysis. A protein with a fold change greater than 2 and p value less than 0.05 in at least one comparison group was considered as a significant one in protein abundance change.
With all data cleaned and processed, visualization was the next step to clearly illustrate the proteomics profiles.</p>
</div>
<div id="visualization-of-pick-up-proteins-in-independent-experiments-and-biological-replicates" class="section level3">
<h3>Visualization of pick-up proteins in independent experiments and biological replicates</h3>
<p>Before moving on, we checked all proteins identified in all replicates and visualized them via Venn Diagram. As shown, a total of 1372 proteins survived in the filtering step and they were used for subsequent analyses.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/Venn-Diagram-1.svg" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="overall-impression-of-proteome-dataset" class="section level3">
<h3>Overall impression of proteome dataset</h3>
<p>Data reproducibility between biological replicates were examined by a PCA analysis. The comparison between 1000 pfu PR8 Blood vs PBS Blood was included. From the PCA plot, we can clearly see that the comparison between 1000 pfu PR8 blood and PBS blood was similar to that of 1000 pfu PR8 BM versus PBS BM. Another similar comparison was also identified in 1000 pfu PR8 blood vs 1000 pfu PR8 BM and PBS blood and PBS BM.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/PCA-analysis-with-flu-blood-vs-pbs-blood-1.svg" width="768" style="display: block; margin: auto;" /><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/PCA-analysis-with-flu-blood-vs-pbs-blood-2.svg" width="768" style="display: block; margin: auto;" /></p>
<p>As the comparison between 1000 pfu PR8 blood vs PBS blood was calculated <em>in silico</em>, it was removed temporarily from the following analysis unless indicated. We redrawn the PCA plot with the aforementioned group removed.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/PCA-analysis-1.svg" width="768" style="display: block; margin: auto;" /><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/PCA-analysis-2.svg" width="768" style="display: block; margin: auto;" /></p>
<p>The heatmap for all proteins was also generatef for an overall impression of expression profiles. The first one included the <em>in silico</em> calculated group.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/heatmap-for-all-proteins-with-flu-blood-vs-pbs-blood-1.svg" width="576" style="display: block; margin: auto;" /></p>
<p>The next heatmap was without the <em>in silico</em> calculated group.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/heatmap-for-all-proteins-1.svg" width="576" style="display: block; margin: auto;" /></p>
<p>We then submitted the identified proteins to DAVID database to investigate the cellular compartments they belong to.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/david-GO-analysis-1.svg" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="analysis-of-proteins-with-significant-abundance-changes" class="section level3">
<h3>Analysis of proteins with significant abundance changes</h3>
<p>Proteins with significant expression changes across at least one comparison group were filterd out. The 155 protein expression matrix was subjected to <code>fviz_nbclust</code> using <code>wss</code> method to determine the optimal cluster for visualization.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/potential-cluster-number-1.svg" width="576" style="display: block; margin: auto;" /></p>
<p>Based on the figure, 9 clusters were the best one to separate protein expression difference.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/heatmap-for-signifant-1.svg" width="576" style="display: block; margin: auto;" /></p>
<p>All analyses above were only about all proteins from different comparison group. To identify proteins in each comparison group, we visualized data with volcano plots. The dataset was first cleaned for the subsequent visualization and the volcano plots were shown below.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/volcano-plot-list-1.svg" width="1920" style="display: block; margin: auto;" /></p>
<p>We are also interested in the pathways these proteins involved. Therefore, we filtered the proteins and annotated them as down or up. They were used to search the Reactome database respectively and retrieved the pathway data for visualization.</p>
<p>Because in blood tissues, many proteins related to ribisome were downregulated and they would interfere the final outputs. To address this, we separated them first and proceeded to visualization.</p>
<p>We first checked the proteins without ribisome “contamination”.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/pathway-exclude-ribosomes-1.svg" width="960" style="display: block; margin: auto;" /></p>
<p>And then the proteins related to ribisomes were visualized.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/pathway-include-ribosomes-1.svg" width="960" style="display: block; margin: auto;" /></p>
<p>Finally we used the alluvival flow to show the protein abundance changes from PBS BM to 1000 pfu PR8 BM and then Blood and BAL.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/ggalluvial-1.svg" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="ibaq-intensity-ranking" class="section level3">
<h3>iBAQ intensity ranking</h3>
<p>The intensity data were extracted from iBAQ values and only the proteins identified in both experiments were used. Ranking all proteins based on their iBAQ intensity values is a good alternative to visualize their abundance in a cell when no abosulte copy number is available.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/visualised-intensity-ranking-1.svg" width="1536" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="analysis-of-bal-neutrophil-proteome-changes-following-different-doses-of-influenza-infection-or-bacterial-infection" class="section level2">
<h2>Analysis of BAL neutrophil proteome changes following different doses of influenza infection or bacterial infection</h2>
<div id="raw-data-cleaning-1" class="section level3">
<h3>Raw data cleaning</h3>
<p>The above data analysis revealed that neutrophils underwent proteomics profile changes during influenza infection. To investigate whether it is a pathogen specific or a dose-dependent response during infection. We performed another round of proteomics experiment where the design was shown below:</p>
<table>
<caption><strong>Experiment 3 Biological replicate 1</strong></caption>
<thead>
<tr class="header">
<th align="left">Labelling</th>
<th align="left">Sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Light (L)</td>
<td align="left">100 pfu PR8 BAL neutrophil</td>
</tr>
<tr class="even">
<td align="left">Medium (M)</td>
<td align="left">1000 pfu PR8 BAL neutrophil</td>
</tr>
<tr class="odd">
<td align="left">Heavy (H)</td>
<td align="left">3 × 10<sup>6</sup> CFU <em>Pseudomonas Aeruginosa</em> BAL neutrophil</td>
</tr>
</tbody>
</table>
<table>
<caption><strong>Experiment 3 Biological replicate 2</strong></caption>
<thead>
<tr class="header">
<th align="left">Labelling</th>
<th align="left">Sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Light (L)</td>
<td align="left">1000 PFU PR8 BAL neutrophil</td>
</tr>
<tr class="even">
<td align="left">Medium (M)</td>
<td align="left">3 × 10<sup>6</sup> CFU <em>Pseudomonas Aeruginosa</em> BAL neutrophil</td>
</tr>
<tr class="odd">
<td align="left">Heavy (H)</td>
<td align="left">100 pfu PR8 BAL neutrophil</td>
</tr>
</tbody>
</table>
<table>
<caption><strong>Experiment 3 Biological replicate 3</strong></caption>
<thead>
<tr class="header">
<th align="left">Labelling</th>
<th align="left">Sample</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Light (L)</td>
<td align="left">3 × 10<sup>6</sup> CFU <em>Pseudomonas Aeruginosa</em> BAL neutrophil</td>
</tr>
<tr class="even">
<td align="left">Medium (M)</td>
<td align="left">100 PFU PR8 BAL neutrophil</td>
</tr>
<tr class="odd">
<td align="left">Heavy (H)</td>
<td align="left">1000 PFU PR8 BAL neutrophil</td>
</tr>
</tbody>
</table>
<p>We first tried data cleaning for this dataset. The proteins with different abundance were also filtered out.</p>
</div>
<div id="overall-impression-of-datasets" class="section level3">
<h3>Overall impression of datasets</h3>
<p>Then we generated a PCA analysis to look at the protein abundance pattern.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/PCA-plot-for-the-proteome-involved-bacterial-infection-1.svg" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="analysis-of-proteins-with-significant-abundance-changes-1" class="section level3">
<h3>Analysis of proteins with significant abundance changes</h3>
<p>Lastly, a heatmap for all proteins with different abundance detected in at least one group was visualized.</p>
<p>The cluster number was first determined by <code>fviz_nbclust</code> function with <code>wss</code> method.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/determine-the-clusters-for-data_201712-1.svg" width="576" style="display: block; margin: auto;" /></p>
<p>Based on the plot, we can see 3 clusters are the best option to visualize the dataset.</p>
<p><img src="/post/2019-01-25-neutrophil-proteomics-data-analysis-following-influenza-or-bacterial-infection_files/figure-html/heatmap-for-the-proteome-involved-bacterial-infection-1.svg" width="864" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="state-of-the-machine" class="section level2">
<h2>State of the machine</h2>
<pre><code>## sessionInfo()
## R version 3.5.1 (2018-07-02)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 17763)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_Australia.1252  LC_CTYPE=English_Australia.1252   
## [3] LC_MONETARY=English_Australia.1252 LC_NUMERIC=C                      
## [5] LC_TIME=English_Australia.1252    
## 
## attached base packages:
##  [1] parallel  stats4    grid      stats     graphics  grDevices utils    
##  [8] datasets  methods   base     
## 
## other attached packages:
##  [1] blogdown_0.12         ggpubr_0.2            corrplot_0.84        
##  [4] scatterpie_0.1.2      ggthemr_1.1.0         org.Mm.eg.db_3.7.0   
##  [7] AnnotationDbi_1.44.0  IRanges_2.16.0        S4Vectors_0.20.1     
## [10] Biobase_2.42.0        BiocGenerics_0.28.0   customLayout_0.3.0   
## [13] glue_1.3.1            ggalluvial_0.9.1      RColorBrewer_1.1-2   
## [16] egg_0.4.2             cowplot_0.9.4         data.table_1.12.2    
## [19] factoextra_1.0.5      gridExtra_2.3         ComplexHeatmap_1.20.0
## [22] eulerr_5.1.0          ggthemes_4.2.0        ggrepel_0.8.1        
## [25] magrittr_1.5          forcats_0.4.0         stringr_1.4.0        
## [28] dplyr_0.8.0.1         purrr_0.3.2           readr_1.3.1          
## [31] tidyr_0.8.3           tibble_2.1.1          ggplot2_3.1.1        
## [34] tidyverse_1.2.1      
## 
## loaded via a namespace (and not attached):
##  [1] nlme_3.1-137        fs_1.3.1            lubridate_1.7.4    
##  [4] bit64_0.9-7         httr_1.4.0          tools_3.5.1        
##  [7] backports_1.1.4     R6_2.4.0            DBI_1.0.0          
## [10] lazyeval_0.2.2      colorspace_1.4-1    GetoptLong_0.1.7   
## [13] withr_2.1.2         processx_3.3.1      tidyselect_0.2.5   
## [16] bit_1.1-14          compiler_3.5.1      cli_1.1.0          
## [19] rvest_0.3.3         pacman_0.5.1        xml2_1.2.0         
## [22] bookdown_0.10       labeling_0.3        scales_1.0.0       
## [25] callr_3.2.0         digest_0.6.18       rmarkdown_1.12     
## [28] pkgconfig_2.0.2     htmltools_0.3.6     rlang_0.3.4        
## [31] GlobalOptions_0.1.0 readxl_1.3.1        rstudioapi_0.10    
## [34] RSQLite_2.1.1       shape_1.4.4         generics_0.0.2     
## [37] farver_1.1.0        jsonlite_1.6        Rcpp_1.0.1         
## [40] munsell_0.5.0       clipr_0.6.0         whisker_0.3-2      
## [43] stringi_1.4.3       yaml_2.2.0          MASS_7.3-50        
## [46] plyr_1.8.4          blob_1.1.1          crayon_1.3.4       
## [49] lattice_0.20-35     haven_2.1.0         circlize_0.4.6     
## [52] hms_0.4.2           polylabelr_0.1.0    ps_1.3.0           
## [55] knitr_1.22          pillar_1.4.0        rjson_0.2.20       
## [58] reprex_0.2.1        evaluate_0.13       modelr_0.1.4       
## [61] tweenr_1.0.1        cellranger_1.1.0    gtable_0.3.0       
## [64] polyclip_1.10-0     assertthat_0.2.1    xfun_0.6           
## [67] ggforce_0.2.2       broom_0.5.2         rvcheck_0.1.3      
## [70] memoise_1.1.0         </code></pre>
</div>
